<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>文章比對</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f4;
        }
        h1, h2 {
            color: #333;
        }
        p {
            text-align: left; /* 文章靠左顯示 */
        }
        textarea {
            width: 100%;
            height: 100px;
            font-size: 16px; /* 字體大小設置為16px */
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.1);
            resize: none; /* 禁止調整大小 */
        }
        button {
            color: white;
            border: none;
            border-radius: 5px;
            padding: 10px 15px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 10px;
            margin-right: 5px; /* 右側間距 */
            transition: background 0.3s; /* 漸變效果 */
        }
        button:hover {
            opacity: 0.9; /* 鼠標懸停效果 */
        }
        .error {
            color: red;
        }
        .success {
            color: green;
        }
        #result {
            margin-top: 15px;
            font-size: 18px; /* 結果文字稍微放大 */
            text-align: center; /* 中間對齊 */
        }
        .time {
            margin-top: 10px;
            font-size: 16px; /* 使用時間文字大小 */
        }
        /* 漸層顏色按鈕 */
        .btn-comma {
            background: linear-gradient(45deg, #ff6b6b, #ff9a9e);
        }
        .btn-period {
            background: linear-gradient(45deg, #6a82fb, #fc5c7d);
        }
        .btn-semicolon {
            background: linear-gradient(45deg, #fbc2eb, #a6c1ee);
        }
        .btn-colon {
            background: linear-gradient(45deg, #84fab0, #8fd3f4);
        }
    </style>
</head>
<body>

    <h1>學習文章</h1>
    <p id="originalText">
        小明是一位熱愛大自然的孩子。他每天放學後都會到公園玩耍，觀察花朵和樹木。小明特別喜歡昆蟲，經常蹲在草地上看螞蟻和蝴蝶。每當他看到這些可愛的生物，心中充滿了喜悅。小明的媽媽告訴他要愛護大自然，不能隨便破壞環境。於是，小明決定成為環保小天使，幫助清理公園的垃圾，讓大自然變得更加美麗。他希望每個人都能一起愛護地球，讓生活的環境更健康快樂。
    </p>

    <h2>漏打字元</h2>
    <p id="result"></p>

    <h2>請在下方輸入你的內容：</h2>
    <textarea id="studentInput" placeholder="在這裡輸入你的內容..." onpaste="return false;" onfocus="startTimer()" oninput="checkInput()"></textarea><br>
    <button onclick="toggleTimer()">暫停/繼續計時</button>

    <div>
        <button onclick="changeFontSize(1)">放大文字</button>
        <button onclick="changeFontSize(-1)">縮小文字</button>
        <button class="btn-comma" onclick="insertPunctuation('，')">插入「，」</button>
        <button class="btn-period" onclick="insertPunctuation('。')">插入「。」</button>
        <button class="btn-semicolon" onclick="insertPunctuation('；')">插入「；」</button>
        <button class="btn-colon" onclick="insertPunctuation('：')">插入「：」</button>
    </div>

    <p class="time" id="timeUsed">使用時間: 00:00:00</p>
    <p class="time" id="wordCount">字數: 0</p>
    <p class="time" id="accuracy">正確率: 0% | 錯誤率: 100%</p>
    <p id="feedback"></p>

    <script>
        let startTime;
        let timerInterval;
        let elapsedTime = 0; // 總計時間（秒）
        let isPaused = true; // 計時器是否暫停

        function removePunctuation(text) {
            return text.replace(/[，。！？；：]/g, '').replace(/\s+/g, '');
        }

        function checkInput() {
            if (!startTime) {
                startTime = new Date();
            }

            const correctAnswer = "小明是一位熱愛大自然的孩子。他每天放學後都會到公園玩耍，觀察花朵和樹木。小明特別喜歡昆蟲，經常蹲在草地上看螞蟻和蝴蝶。每當他看到這些可愛的生物，心中充滿了喜悅。小明的媽媽告訴他要愛護大自然，不能隨便破壞環境。於是，小明決定成為環保小天使，幫助清理公園的垃圾，讓大自然變得更加美麗。他希望每個人都能一起愛護地球，讓生活的環境更健康快樂。";
            const studentInput = document.getElementById("studentInput").value.trim();
            const result = document.getElementById("result");

            // 比對輸入的內容與正確答案
            let markedAnswer = '';
            let inputIndex = 0;
            let correctCount = 0;

            for (let i = 0; i < correctAnswer.length; i++) {
                if (inputIndex < studentInput.length && correctAnswer[i] === studentInput[inputIndex]) {
                    markedAnswer += correctAnswer[i]; // 正確的字
                    inputIndex++;
                    correctCount++; // 計算正確字數
                } else {
                    markedAnswer += `<span style="color: red;">${correctAnswer[i]}</span>`; // 錯誤的字
                }
            }

            // 更新結果顯示
            result.innerHTML = markedAnswer;

            // 隱藏原文章
            document.getElementById("originalText").style.display = "none";

            // 更新字數
            document.getElementById("wordCount").innerHTML = `字數: ${studentInput.length}`;

            // 計算正確率和錯誤率
            const totalChars = correctAnswer.length;
            const accuracy = (correctCount / totalChars) * 100;
            const errorRate = 100 - accuracy;

            document.getElementById("accuracy").innerHTML = `正確率: ${accuracy.toFixed(2)}% | 錯誤率: ${errorRate.toFixed(2)}%`;

            // 顯示鼓勵的話
            let feedback = '';
            if (accuracy === 100) {
                clearInterval(timerInterval); // 停止計時
                feedback = "太棒了！你完全正確！";
                alert(`結果: 正確率: ${accuracy.toFixed(2)}%\n使用時間: ${formatTime(elapsedTime)}`);
            } else if (accuracy >= 80) {
                feedback = "很好！繼續保持！";
            } else if (accuracy >= 50) {
                feedback = "不錯！再加油！";
            } else {
                feedback = "別氣餒！多加練習會更好！";
            }
            document.getElementById("feedback").innerHTML = feedback;

            // 計算使用時間
            const endTime = new Date();
            const timeUsed = Math.round((endTime - startTime) / 1000); // 使用時間（秒）
            document.getElementById("timeUsed").innerHTML = `使用時間: ${formatTime(elapsedTime)}`;
        }

        function formatTime(seconds) {
            const hours = Math.floor(seconds / 3600);
            const minutes = Math.floor((seconds % 3600) / 60);
            const secs = seconds % 60;
            return `${padZero(hours)}:${padZero(minutes)}:${padZero(secs)}`;
        }

        function padZero(num) {
            return num < 10 ? '0' + num : num;
        }

        function startTimer() {
            if (isPaused) {
                isPaused = false;
                startTime = new Date() - elapsedTime * 1000; // 計算開始時間
                timerInterval = setInterval(() => {
                    elapsedTime = Math.floor((new Date() - startTime) / 1000);
                    document.getElementById("timeUsed").innerHTML = `使用時間: ${formatTime(elapsedTime)}`;
                }, 1000);
            }
        }

        function toggleTimer() {
            if (isPaused) {
                startTimer();
            } else {
                clearInterval(timerInterval);
                isPaused = true;
            }
        }

        function changeFontSize(change) {
            const currentSize = parseFloat(getComputedStyle(document.body).fontSize);
            document.body.style.fontSize = (currentSize + change) + 'px';
        }

        function insertPunctuation(punctuation) {
            const textarea = document.getElementById("studentInput");
            const start = textarea.selectionStart;
            const end = textarea.selectionEnd;
            // 在光標位置插入標點符號
            textarea.value = textarea.value.substring(0, start) + punctuation + textarea.value.substring(end);
            // 將光標移到插入的標點符號後面
            textarea.selectionStart = textarea.selectionEnd = start + 1;
            textarea.focus();
        }
    </script>

</body>
</html>